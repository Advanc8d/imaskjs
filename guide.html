<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Imaskjs - vanilla javascript imput mask</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/kube/6.5.2/css/kube.min.css">
    <link rel="stylesheet" href="gh-pages/css/main.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <main>
      <header>
        <div>
          <h1 class="title"><a href="/">imask<sub>js</sub></a></h1>
          <em>vanilla javascript input mask</em>
        </div>
        <nav class="breadcrumbs push-center">
          <ul>
            <li><a href="#common">common</a></li>
            <li><a href="#pattern">pattern</a></li>
            <li><a href="#number">number</a></li>
            <li><a href="#date">date</a></li>
          </ul>
        </nav>
      </header>
      <section>
        <h2 id="getting-started" class="section-h"><a href="#getting-started">Getting Started</a></h2>
        <p>Include <code>imask.js</code> or <code>imask.min.js</code> from <code>dist</code> folder:</p>
        <pre><code>&lt;script src=&quot;dist/imask.js&quot;&gt;&lt;/script&gt;</code></pre>
        <p>Simple usage case:</p>
        <pre><code>var element = document.getElementById('selector');
var maskOptions = {
  mask: '+{7}(000)000-00-00'
};
var mask = new IMask(element, maskOptions);</code></pre>

        <p>Since version 1.0.0 mask was splitted up to model and view layers.<br>
        Model layer contains all masking facilities which could be used independently with no UI.<br>
        View layer is just a glue between UI component and model, it connects listeners and controls changes in both directions.</p>
        <p>View layer currently consist only of a single component to support <code>input</code>-like API. Instance of that type is returned by calling IMask.</p>
        // TODO write about supporting older
        <p>Basic use case:</p>
        <pre><code>var mask = new IMask(element, maskOptions);</code></pre>
        <p>get/set value and unmasked value</p>
        <pre><code>mask.value = "+7(999)999-99-99";
console.log(mask.value);  // logs "+7(999)999-99-99"
console.log(mask.unmaskedValue);  // logs "79999999999"

mask.unmaskedValue = "70000000000";
console.log(mask.value);  // logs "+7(000)000-00-00"
console.log(mask.unmaskedValue);  // logs "70000000000"</code></pre>

        <p>get/set mask</p>
        <pre><code>mask.mask = "000-000"; // auto-updates UI</code></pre>

        <p>update options</p>
        <pre><code>mask.updateOptions({
  mask: Number,
  min: 0,
  max: 100
});  // also updates UI</code></pre>

        <p>clean and destroy</p>
        <pre><code>mask.destroy();</code></pre>

        <p>listen to events</p>
        <pre><code>// 'accept' event fired on input when mask value has changed
function log () {console.log(mask.value)};
mask.on("accept", log);

// 'complete' event fired when the value is completely filled
// This makes sense only for Pattern-based masks
mask.on("complete", function () {console.log(mask.value)});</code></pre>
        <p>unlisten to events</p>
        <pre><code>mask.off("accept", log);

// omit handler argument to unlisten all
mask.off("complete");</code></pre>

        <p>get masked model</p>
        <pre><code>var masked = mask.masked;
masked.reset(); // UI will NOT be updated</code></pre>

        <p>In example above any changes are proxied to model layer at first and then UI gets updated. The core of masking on model layer is <a href="#common">IMask.Masked</a> base class.
        There are also several other model classes which corresponds to <code>mask</code> property type and provides additional functionality:</p>
        <table>
          <thead>
            <tr>
              <th><code>mask</code> prop</th>
              <th>Model class</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>instance of <code>RegExp</code> or<br>
              type of <code>Function</code> or<br>
              child of <code>IMask.Masked</code> or<br>
              instance of <code>IMask.Masked</code></td>
              <td><a href="#common">IMask.Masked</a></td>
            </tr>
            <tr>
              <td>type of <code>String</code></td>
              <td><a href="#pattern">IMask.MaskedPattern</a></td>
            </tr>
            <tr>
              <td><code>Number</code></td>
              <td><a href="#number">IMask.MaskedNumber</a></td>
            </tr>
            <tr>
              <td><code>Date</code></td>
              <td><a href="#date">IMask.MaskedDate</a></td>
            </tr>
          </tbody>
        </table>


        <h2 id="common" class="section-h"><a href="#common">Common</a></h2>
        <p><a href="#common">IMask.Masked</a> is a base class of all other *Masked. When you call IMask with mask options they are just directly passed to Masked model.</p>
        <p>Usually you don't need manually create instances of that type, because it will be done by IMask internally. But you can subclass from it to add some specific behavior like uppercasing for example.</p>
        <p>Additionaly to <code>mask</code> option you could pass custom validator as <code>validate</code> option for some complex checks on any mask types except <code>Function</code> and <code>RegExp</code>, because they are already validators itself.</p>
        <p><strong>Make sure that your mask or validator not just accept final value, but also any of intermediate states. Otherwise value will be cleared.</strong></p>
        <p>Example usage:</p>
        <pre><code>var masked = new IMask.Masked({
  mask: /^\d+$/,  // mask is mandatory
  validate: function (value, masked) {  // optional validator
    // let restrict input to start with '2'
    return value.indexOf('2') === 0;
  }
});</code></pre>
        <p>get/set mask (only same type allowed!)</p>
        <pre><code>masked.mask = /^\s+$/;  // ok
masked.mask = "0000";  // ERROR! changing mask type on existing mask is not allowed!</code></pre>
        <p>get/set value and unmasked value</p>
        <pre><code>masked.value = 'hello world!';
console.log(masked.unmaskedValue);</code></pre>
        <p>Override <code>commit</code> method to make some postprocessing after UI was deactivated.</p>


        <h2 id="pattern" class="section-h"><a href="#pattern">Pattern</a></h2>
        Use pattern when:
        <ul>
          <li>mask is complex</li>
          <li>mask is fixed in size (optional symbols gives some flexibility)</li>
          <li>placeholder is needed</li>
          <li>more reliability or flexibility on processing input is needed</li>
        </ul>
        <p>Pattern mask is just string:</p>
        <pre><code>var patternMask = new IMask(element, {
  mask: '{#}000[aaa]/NIC-`*[**]'
});

// or without UI
var masked = new IMask.PatternMasked({
  mask: '{#}000[aaa]/NIC-`*[**]'
});</code></pre>
        where:
        <ul class="unstyled">
        <li><code>0</code> - any digit input</li>
        <li><code>a</code> - any letter input</li>
        <li><code>*</code> - any char input</li>
        <li>other chars (not defined in custom options) supposed to be <em>fixed</em></li>
        <li><code>[]</code> - make input optional</li>
        <li><code>{}</code> - include fixed in unmasked value</li>
        <li><code>`</code> - prevent symbols shift back</li>
        </ul>
        <p>If definition character should be treated as fixed it should be escaped by <code>\\</code> (E.g. <code>\\0</code>).</p>

        <p>Additionally you could provide custom <code>definitions</code>:</p>
        <pre><code>var zipMask = new IMask(element, {
  mask: '#00000',
  definitions: {
    // &lt;any single char&gt;: &lt;same type as mask (RegExp, Function, etc.)&gt;
    // defaults are '0', 'a', '*'
    '#': /[1-6]/
  }
});</code></pre>
        <p>To configure placeholder use <code>placeholder</code> option:</p>
        <pre><code>var phoneMask = new IMask(element, {
  mask: '+{7}(000)000-00-00'
  placeholder: {
    lazy: false,  // make placeholder always visible
    char: '#'  // defaults to '_'
  }
});</code></pre>
        <p>One more custom options for pattern is <code>groups</code>:</p>
        <pre><code>var groupsMask = new IMask(element, {
  mask: 'Ple\\ase fill ye\\ar 19<ins>YY</ins>, month <ins>MM</ins> \\and v\\alue <ins>VL</ins>',
  placeholder: {
    lazy: false,  // make placeholder always visible
  },
  groups: {
    // custom group definition
    <ins>YY</ins>: {
      mask: '00',
      // optional validator
      // validate: function (value, group) {}
    },

    // use range to restrict input to numbers in range
    // mask size is the length in chars of max bound or could be provided as second parameter
    // to input smaller values pad zeros at beginning
    <ins>MM</ins>: new IMask.MaskedPattern.Group.Range([1, 12], /* optional size */),

    // restrict input to enum
    // all values should be same length
    <ins>VL</ins>: new IMask.MaskedPattern.Group.Enum(['TV', 'HD', 'VR']),
  }
});</code></pre>

// TODO Number mask
// TODO Date mask
// TODO demo for every code

        <h2 id="examples" class="section-h"><a href="#examples">Examples</a></h2>
        <h3 id="ex-phone" class="section-h"><a href="#ex-phone">Phone number</a></h3>
        <pre><code>var phoneMask = new IMask(document.getElementById('phone-mask'), {
  mask: '+{7}(000)000-00-00'
}).on('accept', function() {/* ... */})
.on('complete', function() {/* ... */});</code></pre>

        <h3 id="ex-numbers" class="section-h"><a href="#ex-numbers">Only numbers</a></h3>
        <pre><code>var numbersMask = new IMask(document.getElementById('numbers-mask'), {
  mask: function (str, details) {
    var inserted = details.inserted;
    if (!inserted.length) return true;
    var insertedNumbers = inserted.replace(/\D/g, '');

    details.cursorPos -= inserted.length - insertedNumbers.length;
    return details.head + insertedNumbers + details.tail;
  }
});</code></pre>

        <h3 id="ex-uppercase" class="section-h"><a href="#ex-uppercase">Pipe uppercase</a></h3>
        <pre><code>var uppercaseMask = new IMask(document.getElementById('uppercase-mask'), {
  mask: [
    {
      mask: "aaa"
    },
    {
      mask: function (str) {
        return str.toUpperCase();
      }
    }
  ]
});</code></pre>

        <h2 id="demo" class="section-h"><a href="#demo">Demo</a></h2>
        <h3 id="demo-phone" class="section-h"><a href="#demo-phone">Phone number</a></h3>
        <form class="form example-phone">
          <div class="form-item">
            <label>Type here against mask <span class="desc">+{7}(000)000-00-00</span></label>
            <input id="phone-mask" type="text" value="">
            <div class="desc">unmasked: <span id="phone-unmasked"></span><span id="phone-complete" class="example__complete"></span></div>
          </div>
        </form>

        <h3 id="demo-regexp" class="section-h"><a href="#demo-regexp">Only regexp</a></h3>
        <form class="form example-regexp">
          <div class="form-item">
            <label>Type here</label>
            <input id="regexp-mask" type="text" value="">
          </div>
        </form>

        <h3 id="demo-numbers" class="section-h"><a href="#demo-numbers">Only numbers</a></h3>
        <form class="form example-numbers">
          <div class="form-item">
            <label>Type here</label>
            <input id="numbers-mask" type="text" value="">
            <div class="desc">number: <span id="number-value"></span></div>
          </div>
        </form>

        <h3 id="demo-date" class="section-h"><a href="#demo-date">Date</a></h3>
        <form class="form example-date">
          <div class="form-item">
            <label>Type here</label>
            <input id="date-mask" type="text" value="">
            <div class="desc">date: <span id="date-value"></span></div>
          </div>
        </form>

        <h3 id="demo-func" class="section-h"><a href="#demo-func">Functional validator</a></h3>
        <form class="form example-func">
          <div class="form-item">
            <label>Type here</label>
            <input id="func-mask" type="text" value="">
          </div>
        </form>

        <h3 id="demo-uppercase" class="section-h"><a href="#demo-uppercase">Uppercase</a></h3>
        <form class="form example-uppercase">
          <div class="form-item">
            <label>Type here</label>
            <input id="uppercase-mask" type="text" value="">
          </div>
        </form>

        <h3 id="demo-custom" class="section-h"><a href="#demo-custom">Custom mask</a></h3>
        <form class="form example-custom">
          <div class="form-item">
            <label>Type here</label>
            <input id="custom-mask" type="text" value="">
            <div class="desc">unmasked: <span id="custom-unmasked"></span><span id="custom-complete" class="example__complete"></span></div>
          </div>
          <fieldset>
            <legend>Options</legend>
            <div class="row gutters">
              <div class="col col-4">
                <div class="form-item">
                  <label>Mask</label>
                  <input type="text" name="mask" value="000[aaa]XXX`***">
                </div>
              </div>
              <div class="col col-4">
                <div class="form-item">
                  <label>Placeholder mode</label>
                  <label class="checkbox"><input type="checkbox" name="ph-show">lazy</label>
                </div>
              </div>
              <div class="col col-4">
                <div class="form-item">
                  <label>Placeholder char</label>
                  <input type="text" maxlength="1" name="ph-char" value="_">
                </div>
              </div>
            </div>
          </fieldset>
          <fieldset>
            <legend>Values</legend>
             <div class="row gutters align-middle">
              <div class="col col-4">
                <div class="form-item">
                  <label>Set raw value</label>
                  <input type="text" name="raw" value="">
                </div>
              </div>
              <span class="desc">&nbsp;or&nbsp;</span>
              <div class="col col-4">
                <div class="form-item">
                  <label>Set unmasked value</label>
                  <input type="text" name="unmasked" value="">
                </div>
              </div>
            </div>
          </fieldset>
          <div class="form-item">
            <button name="apply" type="button">Apply</button>
          </div>
        </form>
      </section>
      <footer>
        <nav class="breadcrumbs push-center">
          <ul>
            <li><span class="active">donate</span></li>
            <li><a href="https://www.paypal.me/alexeykryazhev/5" target="_blank">$5</a></li>
            <li><a href="https://www.paypal.me/alexeykryazhev/10" target="_blank">$10</a></li>
            <li><a href="https://www.paypal.me/alexeykryazhev/20" target="_blank">$20</a></li>
            <li><a href="https://www.paypal.me/alexeykryazhev/50" target="_blank">$50</a></li>
            <li><span class="active">to support</span></li>
          </ul>
        </nav>
        <a href="https://github.com/uNmAnNeR">@Alexey Kryazhev</a>
      </footer>
    </main>
    <script src="dist/imask.js"></script>
    <script type="text/javascript">
      var phoneMask = new IMask(document.getElementById('phone-mask'), {
        mask: '+{7}(000)000-00-00'
      }).on('accept', function() {
        document.getElementById('phone-complete').style.display = '';
        document.getElementById('phone-unmasked').innerHTML = phoneMask.unmaskedValue;
      }).on('complete', function() {
        document.getElementById('phone-complete').style.display = 'inline-block';
      });

      new IMask(document.getElementById('regexp-mask'), {
        mask: /^[1-6]\d{0,5}$/
      });

      var numberMask = new IMask(document.getElementById('numbers-mask'), {
        mask: Number,
        scale: 2,
        // signed: true,
        thousandsSeparator: ' ',
        postFormat: {
          // padFractionalZeros: true,
          normalizeZeros: true,
        },
        min: -1000,
        max: 1000,
        // radix: ',',
        // mapToRadix: ['.']
      });
      numberMask.on('accept', function() {
        document.getElementById('number-value').innerHTML = numberMask.masked.number;
      });

      var dateMask = new IMask(document.getElementById('date-mask'), {
        mask: Date,
        pattern: 'Y-`m-`d',
        placeholder: {
          lazy: false
        },
        format: function (date) {
          var day = date.getDate();
          var month = date.getMonth() + 1;
          var year = date.getFullYear();

          if (day < 10) day = "0" + day;
          if (month < 10) month = "0" + month;

          return [year, month, day].join('-');
        },
        parse: function (str) {
          var [year, month, day] = str.split('-');
          return new Date(year, month - 1, day);
        },
        min: new Date(2000, 0, 1),
        max: new Date(2020, 0, 1)
      });
      dateMask.on('accept', function() {
        document.getElementById('date-value').innerHTML = dateMask.masked.date || '-';
      });

      new IMask(document.getElementById('func-mask'), {
        mask: function (str) {
          return !!Number(str);
        }
      });

      new IMask(document.getElementById('uppercase-mask'), {
        mask: function (value, masked) {
          // TODO why not public API?
          masked._value = masked.value.toUpperCase();
        }
      });

      var customMask = new IMask(document.getElementById('custom-mask'), {
          mask: '000[aaa]XXX`***',
          placeholder: {
            lazy: false
          }
      });
      customMask.on('accept', function() {
        document.getElementById('custom-complete').style.display = '';
        document.getElementById('custom-unmasked').innerHTML = customMask.unmaskedValue;
      }).on('complete', function() {
        document.getElementById('custom-complete').style.display = 'inline-block';
      });

      var customEl = document.getElementsByClassName('example-custom')[0];
      customEl.querySelector('[name=apply]').addEventListener('click', function (e) {
        var mask = customEl.querySelector('[name=mask]').value;
        var ph = {
          lazy: customEl.querySelector('[name=ph-show]').checked,
          char: customEl.querySelector('[name=ph-char]').value || '_'
        };
        var value = customEl.querySelector('[name=raw]').value;
        customEl.querySelector('[name=raw]').value = '';

        var unmaskedValue = customEl.querySelector('[name=unmasked]').value;
        customEl.querySelector('[name=unmasked]').value = '';

        customMask.updateOptions({
          mask: mask,
          placeholder: ph
        });
        if (value) customMask.value = value;
        if (unmaskedValue) customMask.unmaskedValue = unmaskedValue;
      });

    </script>
  </body>
</html>
